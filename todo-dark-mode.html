c:\kata\practice-flow-orchestrator\practice-dark-mode-fixed.html<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlayTime Practice - Dark Mode Fixed</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <style>
        /* Light mode (default) */
        :root {
            --background: 240 10% 98%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --primary: 221.2 83.2% 53.3%;
            --primary-foreground: 210 40% 98%;
            --secondary: 210 40% 96%;
            --secondary-foreground: 222.2 84% 4.9%;
            --muted: 210 40% 96%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --border: 214.3 31.8% 91.4%;
            --ring: 221.2 83.2% 53.3%;
            --practice-confident: 142 76% 36%;
            --practice-unsure: 43 96% 56%;
            --practice-needs-work: 0 84% 60%;
        }

        /* Dark mode */
        .dark {
            --background: 222.2 84% 4.9%;
            --foreground: 210 40% 98%;
            --card: 222.2 84% 4.9%;
            --card-foreground: 210 40% 98%;
            --primary: 210 40% 98%;
            --primary-foreground: 222.2 47.4% 11.2%;
            --secondary: 217.2 32.6% 17.5%;
            --secondary-foreground: 210 40% 98%;
            --muted: 217.2 32.6% 17.5%;
            --muted-foreground: 215 20.2% 65.1%;
            --border: 217.2 32.6% 17.5%;
            --ring: 212.7 26.8% 83.9%;
            --practice-confident: 142 76% 50%;
            --practice-unsure: 43 96% 70%;
            --practice-needs-work: 0 84% 70%;
        }

        /* Ensure body uses the theme colors */
        body {
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Theme-aware utility classes */
        .bg-background { background-color: hsl(var(--background)); }
        .bg-card { background-color: hsl(var(--card)); }
        .bg-card-50 { background-color: hsl(var(--card) / 0.5); }
        .bg-muted { background-color: hsl(var(--muted)); }
        .bg-muted-20 { background-color: hsl(var(--muted) / 0.2); }
        .bg-secondary { background-color: hsl(var(--secondary)); }
        
        .text-foreground { color: hsl(var(--foreground)); }
        .text-card-foreground { color: hsl(var(--card-foreground)); }
        .text-primary { color: hsl(var(--primary)); }
        .text-muted-foreground { color: hsl(var(--muted-foreground)); }
        .text-secondary-foreground { color: hsl(var(--secondary-foreground)); }
        
        .border-border { border-color: hsl(var(--border)); }
        .border-practice-confident { border-color: hsl(var(--practice-confident)); }
        .border-practice-unsure { border-color: hsl(var(--practice-unsure)); }
        .border-practice-needs-work { border-color: hsl(var(--practice-needs-work)); }
        
        .ring-primary { box-shadow: 0 0 0 2px hsl(var(--primary)); }
        
        /* Practice confidence colors */
        .bg-practice-confident-20 { background-color: hsl(var(--practice-confident) / 0.2); }
        .bg-practice-unsure-20 { background-color: hsl(var(--practice-unsure) / 0.2); }
        .bg-practice-needs-work-20 { background-color: hsl(var(--practice-needs-work) / 0.2); }

        /* Custom button styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
            padding: 0.5rem 1rem;
            border: 1px solid transparent;
            cursor: pointer;
        }

        .btn:focus-visible {
            outline: none;
            box-shadow: 0 0 0 2px hsl(var(--ring));
        }

        .btn:disabled {
            pointer-events: none;
            opacity: 0.5;
        }

        .btn-default {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }

        .btn-default:hover {
            background-color: hsl(var(--primary) / 0.9);
        }

        .btn-outline {
            border: 1px solid hsl(var(--border));
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
        }

        .btn-outline:hover {
            background-color: hsl(var(--muted));
        }

        .btn-sm {
            height: 2.25rem;
            padding: 0 0.75rem;
        }

        .btn-icon {
            height: 2.5rem;
            width: 2.5rem;
            padding: 0;
        }

        /* Card styling */
        .card {
            border-radius: 0.5rem;
            border: 1px solid hsl(var(--border));
            background-color: hsl(var(--card));
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            transition: all 0.2s;
        }

        .card:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* Badge styling */
        .badge {
            display: inline-flex;
            align-items: center;
            border-radius: 9999px;
            padding: 0.125rem 0.625rem;
            font-size: 0.75rem;
            font-weight: 600;
            background-color: hsl(var(--secondary));
            color: hsl(var(--secondary-foreground));
        }

        .badge-outline {
            border: 1px solid hsl(var(--border));
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
        }

        /* Dark mode toggle button */
        .theme-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
        }

        /* Sheet music - always light for readability */
        .sheet-music {
            background-color: white !important;
            color: black !important;
        }

        .sheet-music * {
            color: black !important;
        }

        /* Mobile menu styles */
        .mobile-menu {
            position: fixed;
            top: 0;
            left: -320px;
            width: 320px;
            height: 100vh;
            background-color: hsl(var(--card));
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            transition: left 0.3s ease;
            z-index: 1000;
        }

        .mobile-menu.open {
            left: 0;
        }

        .mobile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
            z-index: 999;
        }

        .mobile-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        /* Hide sidebar on mobile */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
        }

        /* Smooth transitions for all elements */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- Dark Mode Toggle -->
    <button onclick="toggleDarkMode()" class="theme-toggle btn btn-outline btn-icon">
        <i data-lucide="sun" class="w-4 h-4 sun-icon"></i>
        <i data-lucide="moon" class="w-4 h-4 moon-icon hidden"></i>
    </button>

    <!-- Mobile Overlay -->
    <div id="mobileOverlay" class="mobile-overlay" onclick="toggleMobileMenu()"></div>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="mobile-menu">
        <div class="p-4 border-b border-border">
            <h2 class="text-lg font-semibold text-foreground">Practice Tools</h2>
        </div>
        <div class="p-4">
            <button onclick="handleFileUpload()" class="btn btn-default w-full">
                <i data-lucide="upload" class="w-4 h-4 mr-2"></i>
                Add a Score
            </button>
        </div>
    </div>

    <!-- Mobile Menu Button -->
    <button onclick="toggleMobileMenu()" class="btn btn-outline btn-icon fixed top-4 left-4 z-50 md:hidden">
        <i data-lucide="menu" class="w-4 h-4"></i>
    </button>

    <div class="min-h-screen bg-background flex">
        <!-- Left Sidebar - Score Library & Controls -->
        <div class="sidebar w-80 border-r border-border bg-card-50 flex flex-col">
            <!-- Header -->
            <div class="p-4 border-b border-border">
                <div class="flex items-center gap-2 mb-4">
                    <i data-lucide="book-open" class="w-5 h-5 text-primary"></i>
                    <h1 class="font-semibold text-lg text-foreground">PlayTime Practice</h1>
                </div>
                
                <button onclick="handleFileUpload()" class="btn btn-default w-full mb-3">
                    <i data-lucide="upload" class="w-4 h-4 mr-2"></i>
                    Add a Score
                </button>
                
                <input id="fileInput" type="file" accept=".pdf" class="hidden" onchange="handleFileChange(event)">
            </div>

            <!-- Current Score Info -->
            <div class="p-4 border-b border-border">
                <div class="text-sm text-muted-foreground mb-1">Current Score</div>
                <div class="font-medium text-sm mb-2 text-foreground" id="currentScoreFilename">alan-menken--disney-part-of-your-world.pdf</div>
                
                <!-- Page Navigation -->
                <div class="flex items-center justify-between mb-4">
                    <button id="prevPageBtn" onclick="handlePageNavigation('prev')" class="btn btn-outline btn-icon">
                        <i data-lucide="chevron-left" class="w-4 h-4"></i>
                    </button>
                    
                    <span class="text-sm font-medium text-foreground" id="pageIndicator">Page 1 of 6</span>
                    
                    <button id="nextPageBtn" onclick="handlePageNavigation('next')" class="btn btn-outline btn-icon">
                        <i data-lucide="chevron-right" class="w-4 h-4"></i>
                    </button>
                </div>

                <!-- Zoom Controls -->
                <div class="flex items-center gap-2 mb-4">
                    <button id="zoomOutBtn" onclick="handleZoom('out')" class="btn btn-outline btn-icon">
                        <i data-lucide="zoom-out" class="w-4 h-4"></i>
                    </button>
                    
                    <span class="text-sm font-medium flex-1 text-center text-foreground" id="zoomIndicator">100%</span>
                    
                    <button id="zoomInBtn" onclick="handleZoom('in')" class="btn btn-outline btn-icon">
                        <i data-lucide="zoom-in" class="w-4 h-4"></i>
                    </button>
                </div>
            </div>

            <!-- Mark Section Confidence -->
            <div class="p-4 border-b border-border">
                <div class="text-sm font-medium mb-3 text-foreground">Mark Section Confidence:</div>
                <div class="space-y-2">
                    <button id="confidentBtn" onclick="setMarkingMode('confident')" class="btn btn-outline btn-sm w-full justify-start">
                        <span class="mr-2">🟢</span>
                        Confident
                    </button>
                    <button id="unsureBtn" onclick="setMarkingMode('unsure')" class="btn btn-outline btn-sm w-full justify-start">
                        <span class="mr-2">🟡</span>
                        Unsure
                    </button>
                    <button id="needsWorkBtn" onclick="setMarkingMode('needs-work')" class="btn btn-outline btn-sm w-full justify-start">
                        <span class="mr-2">🔴</span>
                        Needs Work
                    </button>
                </div>
                <div id="markingInstructions" class="mt-2 text-xs text-muted-foreground hidden">
                    Click and drag on the sheet music to mark sections
                </div>
            </div>

            <!-- Your Scores List -->
            <div class="flex-1 overflow-y-auto">
                <div class="p-4">
                    <div class="text-sm font-medium mb-3 text-foreground">Your Scores</div>
                    <div class="space-y-2" id="scoresList">
                        <!-- Scores will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content - Sheet Music Viewer -->
        <div class="flex-1 flex flex-col">
            <!-- Top Toolbar -->
            <div class="h-14 border-b border-border bg-card-50 flex items-center justify-between px-4">
                <div class="flex items-center gap-2">
                    <h2 class="font-medium text-foreground" id="currentScoreTitle">Disney - Part Of Your World</h2>
                    <span class="badge badge-outline">Practice Mode</span>
                </div>
                
                <div class="flex items-center gap-2">
                    <button class="btn btn-outline btn-icon">
                        <i data-lucide="rotate-cw" class="w-4 h-4"></i>
                    </button>
                    <button class="btn btn-outline btn-icon">
                        <i data-lucide="download" class="w-4 h-4"></i>
                    </button>
                    <button class="btn btn-outline btn-icon">
                        <i data-lucide="settings" class="w-4 h-4"></i>
                    </button>
                </div>
            </div>

            <!-- Sheet Music Display Area -->
            <div class="flex-1 bg-muted-20 p-8 overflow-auto">
                <div class="max-w-4xl mx-auto">
                    <div class="card shadow-lg">
                        <div class="p-0">
                            <!-- Mock Sheet Music Display - Always light for readability -->
                            <div id="sheetMusic" class="sheet-music min-h-[800px] relative overflow-hidden rounded-lg" style="transform: scale(1); transform-origin: top center;">
                                <!-- Title Area -->
                                <div class="text-center py-8 border-b border-gray-200">
                                    <h1 class="text-2xl font-bold mb-2">Part Of Your World</h1>
                                    <p class="text-lg text-gray-600">By Howard Ashman & Alan Menken</p>
                                    <p class="text-sm text-gray-500 mt-2">Piano arr. Gail</p>
                                </div>

                                <!-- Mock Musical Staff Lines -->
                                <div class="p-8 space-y-8" id="musicalStaffs">
                                    <!-- Staff systems will be generated by JavaScript -->
                                </div>

                                <!-- Page Number -->
                                <div class="absolute bottom-4 right-4 text-sm text-gray-500" id="pageNumber">
                                    Page 1
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application State
        let currentPage = 1;
        const totalPages = 6;
        let zoom = 100;
        let markingMode = null;
        let selectedScoreId = 3;

        const mockScores = [
            { id: 1, title: "A Whole New World", filename: "a-whole-new-world.pdf", pages: 3, date: "7/14/2025" },
            { id: 2, title: "Air Supply - All Out Of Love", filename: "air-supply-all-out-of-love.pdf", pages: 4, date: "7/20/2025" },
            { id: 3, title: "Disney - Part Of Your World", filename: "alan-menken--disney-part-of-your-world.pdf", pages: 6, date: "7/19/2025" },
        ];

        // Dark mode functionality
        function toggleDarkMode() {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('darkMode', isDark);
            
            // Update icon visibility
            const sunIcon = document.querySelector('.sun-icon');
            const moonIcon = document.querySelector('.moon-icon');
            
            if (isDark) {
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            } else {
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            }
            
            lucide.createIcons(); // Refresh icons
        }

        // Load saved theme
        function loadTheme() {
            const isDark = localStorage.getItem('darkMode') === 'true';
            if (isDark) {
                document.documentElement.classList.add('dark');
                const sunIcon = document.querySelector('.sun-icon');
                const moonIcon = document.querySelector('.moon-icon');
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            }
        }

        // Initialize the application
        function init() {
            loadTheme();
            lucide.createIcons();
            renderScoresList();
            renderMusicalStaffs();
            updatePageNavigation();
            updateZoomControls();
            updateSelectedScore();
        }

        // Render the scores list
        function renderScoresList() {
            const scoresList = document.getElementById('scoresList');
            scoresList.innerHTML = '';

            mockScores.forEach(score => {
                const scoreCard = document.createElement('div');
                scoreCard.className = `card cursor-pointer ${
                    selectedScoreId === score.id ? 'ring-primary' : ''
                }`;
                scoreCard.onclick = () => selectScore(score.id);
                
                scoreCard.innerHTML = `
                    <div class="p-3">
                        <div class="font-medium text-sm mb-1 text-foreground">${score.title}</div>
                        <div class="text-xs text-muted-foreground mb-2">${score.filename}</div>
                        <div class="flex justify-between items-center">
                            <span class="badge">${score.pages} pages</span>
                            <span class="text-xs text-muted-foreground">${score.date}</span>
                        </div>
                    </div>
                `;
                
                scoresList.appendChild(scoreCard);
            });
        }

        // Render musical staff systems
        function renderMusicalStaffs() {
            const staffsContainer = document.getElementById('musicalStaffs');
            staffsContainer.innerHTML = '';

            for (let system = 1; system <= 4; system++) {
                const systemDiv = document.createElement('div');
                systemDiv.className = 'space-y-4';
                
                // Treble Staff
                const trebleStaff = document.createElement('div');
                trebleStaff.className = 'relative h-16 bg-gradient-to-r from-gray-50 to-gray-100 border border-gray-200 rounded';
                trebleStaff.innerHTML = `
                    <div class="absolute inset-0 flex items-center justify-center text-gray-400">
                        Musical notation would appear here (treble clef)
                    </div>
                `;
                
                // Add sample marking overlay for system 2
                if (system === 2) {
                    const overlay = document.createElement('div');
                    overlay.className = 'absolute inset-2 bg-practice-unsure-20 border-2 border-practice-unsure rounded';
                    trebleStaff.appendChild(overlay);
                }
                
                // Bass Staff
                const bassStaff = document.createElement('div');
                bassStaff.className = 'relative h-16 bg-gradient-to-r from-gray-50 to-gray-100 border border-gray-200 rounded';
                bassStaff.innerHTML = `
                    <div class="absolute inset-0 flex items-center justify-center text-gray-400">
                        Musical notation would appear here (bass clef)
                    </div>
                `;
                
                // Add sample marking overlay for system 3
                if (system === 3) {
                    const overlay = document.createElement('div');
                    overlay.className = 'absolute inset-2 bg-practice-needs-work-20 border-2 border-practice-needs-work rounded';
                    bassStaff.appendChild(overlay);
                }
                
                systemDiv.appendChild(trebleStaff);
                systemDiv.appendChild(bassStaff);
                staffsContainer.appendChild(systemDiv);
            }
        }

        // Handle page navigation
        function handlePageNavigation(direction) {
            if (direction === 'prev' && currentPage > 1) {
                currentPage--;
            } else if (direction === 'next' && currentPage < totalPages) {
                currentPage++;
            }
            updatePageNavigation();
        }

        // Update page navigation UI
        function updatePageNavigation() {
            document.getElementById('pageIndicator').textContent = `Page ${currentPage} of ${totalPages}`;
            document.getElementById('pageNumber').textContent = `Page ${currentPage}`;
            document.getElementById('prevPageBtn').disabled = currentPage === 1;
            document.getElementById('nextPageBtn').disabled = currentPage === totalPages;
        }

        // Handle zoom
        function handleZoom(action) {
            if (action === 'in' && zoom < 200) {
                zoom += 25;
            } else if (action === 'out' && zoom > 50) {
                zoom -= 25;
            }
            updateZoomControls();
            updateSheetMusicZoom();
        }

        // Update zoom controls UI
        function updateZoomControls() {
            document.getElementById('zoomIndicator').textContent = `${zoom}%`;
            document.getElementById('zoomOutBtn').disabled = zoom <= 50;
            document.getElementById('zoomInBtn').disabled = zoom >= 200;
        }

        // Update sheet music zoom
        function updateSheetMusicZoom() {
            const sheetMusic = document.getElementById('sheetMusic');
            sheetMusic.style.transform = `scale(${zoom / 100})`;
        }

        // Set marking mode
        function setMarkingMode(mode) {
            // Reset all buttons
            ['confidentBtn', 'unsureBtn', 'needsWorkBtn'].forEach(id => {
                document.getElementById(id).className = 'btn btn-outline btn-sm w-full justify-start';
            });
            
            // Toggle marking mode
            if (markingMode === mode) {
                markingMode = null;
                document.getElementById('markingInstructions').classList.add('hidden');
            } else {
                markingMode = mode;
                const btnId = mode === 'needs-work' ? 'needsWorkBtn' : mode + 'Btn';
                document.getElementById(btnId).className = 'btn btn-default btn-sm w-full justify-start';
                document.getElementById('markingInstructions').classList.remove('hidden');
            }
        }

        // Select a score
        function selectScore(scoreId) {
            selectedScoreId = scoreId;
            renderScoresList();
            updateSelectedScore();
        }

        // Update selected score info
        function updateSelectedScore() {
            const selectedScore = mockScores.find(score => score.id === selectedScoreId);
            if (selectedScore) {
                document.getElementById('currentScoreFilename').textContent = selectedScore.filename;
                document.getElementById('currentScoreTitle').textContent = selectedScore.title;
            }
        }

        // Handle file upload
        function handleFileUpload() {
            document.getElementById('fileInput').click();
        }

        // Handle file change
        function handleFileChange(event) {
            const file = event.target.files[0];
            if (file) {
                console.log("File uploaded:", file);
            }
        }

        // Toggle mobile menu
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileOverlay = document.getElementById('mobileOverlay');
            
            mobileMenu.classList.toggle('open');
            mobileOverlay.classList.toggle('open');
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
